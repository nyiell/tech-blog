graph TD
    ROOT[Root Compartment<br/>Tag Namespace: Finance] --> PARENT[Parent Compartment<br/>Tag Defaults: CostCenter=Required]

    PARENT --> CHILD1[Child Compartment 1<br/>Tag: CostCenter=Defined<br/>User-Applied]
    PARENT --> CHILD2[Child Compartment 2<br/>Tag: CostCenter=Default<br/>Inherited]

    CHILD1 --> RES1[Resource Creation]
    CHILD2 --> RES2[Resource Creation]

    RES1 -->|Validation| CHECK1{Can reconcile<br/>user value with<br/>parent rules?}
    RES2 -->|Validation| CHECK2{Can apply<br/>default value?}

    CHECK1 -->|No| FAIL1[❌ 400 Invalid Tags]
    CHECK1 -->|Yes| SUCCESS1[✅ Created]

    CHECK2 -->|Yes| SUCCESS2[✅ Created]

    style FAIL1 fill:#ffcccc
    style SUCCESS1 fill:#ccffcc
    style SUCCESS2 fill:#ccffcc
    style CHECK1 fill:#fff4cc
